<% if obj.instance_of? Idea %>
  <% idea = obj %>

  <%# SHOW VIEW %>
  <div class="row well col-md-10 col-md-offset-1">
    
    <% if idea.user == current_user %>
      <%# Dropdown menu %>
      <div class="top-right dropdown">
        <a class="dropdown-toggle" href="#" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fa fa-chevron-down fa-2x" aria-hidden="true"></i>
        </a>
        <ul class="dropdown-menu dropdown-menu-right">
          <li><%= link_to "Edit Idea", edit_idea_path(idea) %></li>
          <li><%= link_to "Delete Idea", idea_path(idea),
                                         method: :delete %></li>
        </ul>
      </div>
    <% end %>
    
    <%# Idea body %>
    <div class="side-margins">
      <div class="idea-body">
        <%= idea.text.html_safe %>
      </div>
    </div>
    
    <div class="row idea-details" align="center">
      <small>
        <%# Left meta-details %>
        <div class="col-md-6">
          Created by: <%= idea.user.full_name.present? ? idea.user.full_name
                                                       : idea.user.email %>
          <br>
          Voting Style: <%= idea.voting_style %>
          <br>
          Anonymous Comments are <%= idea.anonymous_comments? ? 'on'
                                                              : 'off' %>
          <br>
          Real-time votes are <%= idea.reveal_current_votes? ? 'on'
                                                             : 'off' %>
          <br>
          Voter Details are <%= idea.reveal_voter_details? ? 'on'
                                                           : 'off' %>
        </div>
        <%# Right meta-details %>
        <div class="col-md-6">
          Created <%= time_ago_in_words(idea.created_at) %> ago
          <br>
          Last updated <%= time_ago_in_words(idea.updated_at) %> ago
          <br>
          Exact closing time: <%= idea.closing_time %>
          <br>
          <% if idea.open? %>
            Idea will close in <%= time_ago_in_words(idea.closing_time) %>
          <% else %>
            Idea closed about <%= time_ago_in_words(idea.closing_time) %> ago
          <% end %>
          <br>
          Currently open? <%= idea.open? ? 'Yes' : 'No' %>
        </div>
      </small>
    </div>
  </div>
<% else %>
  <% obj.each do |idea| %>

    <%# INDEX VIEW %>
    <div class="row well col-md-10 col-md-offset-1">
      <div class="idea-body">
        <%= link_to idea.text.html_safe, idea_path(idea) %>
      </div>
      <p class="idea-details" align="center">
        <small>
          Created by <%= idea.user.email %> | 
          Created <%= time_ago_in_words(idea.created_at) %> ago | 
          Last updated <%= time_ago_in_words(idea.updated_at) %> ago<br>
          Active days: <%= idea.open_days %> | 
          Closing day: <%= idea.closing_time.to_date %> |
          Active? <%= idea.open? ? 'Yes' : 'No' %><br>
          Voting style: <%= idea.voting_style %> | 
          Anonymous comments: <%= idea.anonymous_comments? ? 'On' : 'Off' %> |
          Show votes: <%= idea.reveal_current_votes? ? 'Yes' : 'No' %> | 
          Anonymous votes: <%= idea.anonymous_comments? ? 'On' : 'Off' %>
        </small>
      </p>
    </div>

  <% end %>
<% end %>
